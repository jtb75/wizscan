package vulnerability

import (
	"fmt"
	"wizscan/pkg/wizapi"
	"wizscan/pkg/wizcli"
)

// PrintVulnerabilityNames now takes two parameters: one for scan results and one for known vulnerabilities.
func CompareVulnerabilities(scanResult wizcli.AggregatedScanResults, knownVulns []wizapi.VulnerabilityNode) {
	// First, print all vulnerabilities found in the scanResult
	for _, lib := range scanResult.Libraries {
	vulnerabilitiesLoop:
		for _, vuln := range lib.Vulnerabilities {
			// Then, compare for known vulnerabilities
			for _, kv := range knownVulns {
				if vuln.Name == kv.Name && lib.Name == kv.DetailedName && vuln.FixedVersion == kv.FixedVersion && lib.DetectionMethod == kv.DetectionMethod {
					continue vulnerabilitiesLoop
				}
			}
			fmt.Printf("UNKNOWN: %s in %s fixed with %s detected in %s\n", vuln.Name, lib.Name, vuln.FixedVersion, lib.DetectionMethod)
		}
	}

}
